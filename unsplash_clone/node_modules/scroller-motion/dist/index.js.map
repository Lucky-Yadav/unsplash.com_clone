{"version":3,"file":"index.js","sources":["../src/context.ts","../src/hooks/useCore/useAxis.ts","../src/hooks/useCore/useSize.ts","../src/components/Core/Wrap.tsx","../src/components/Core/index.tsx","../src/hooks/useCore/index.ts","../src/hooks/useCore/useWindowSize.ts","../src/hooks/useCore/useSpringScroll.ts","../src/hooks/useScrollerMotion.ts"],"sourcesContent":["import { createContext } from 'react'\n\nimport { ScrollerMotionValues } from './types'\n\nexport const Context = createContext<ScrollerMotionValues | undefined>(\n  undefined\n)\n","import { useMemo } from 'react'\nimport { useTransform } from 'framer-motion'\n\nimport { MotionValue } from '../../types'\n\ninterface Options {\n  axisSpring: MotionValue\n  scale: number\n  refSize: number\n  windowSize: number\n}\n\nexport const useAxis = ({\n  axisSpring,\n  scale,\n  refSize,\n  windowSize\n}: Options) => {\n  const scaledSize = useMemo(\n    () => (refSize > windowSize ? refSize * scale : refSize),\n    [refSize, scale, windowSize]\n  )\n\n  const transformFrom = useMemo(\n    () => [0, scaledSize - windowSize],\n    [scaledSize, windowSize]\n  )\n  const transformTo = useMemo(\n    () => [0, (refSize - windowSize) * -1],\n    [refSize, windowSize]\n  )\n\n  const axis = useTransform(axisSpring, transformFrom, transformTo, {\n    clamp: false\n  })\n\n  return {\n    axis,\n    size: scaledSize\n  }\n}\n","import { useEffect, useState } from 'react'\nimport debounceFn from 'debounce-fn'\n\nimport { ChildrenRef } from '../../types'\n\nconst getSize = (el: HTMLElement | null) => ({\n  height: el?.scrollHeight ?? 0,\n  width: el?.scrollWidth ?? 0\n})\n\nconst supportsResizeObserver = typeof ResizeObserver === 'function'\n\nexport const useSize = (ref: ChildrenRef) => {\n  const [size, setSize] = useState({ height: 0, width: 0 })\n\n  useEffect(() => {\n    const onResize = () => setSize(getSize(ref.current))\n    const debouncedOnResize = debounceFn(onResize, { wait: 400 })\n    let resizeObserver: ResizeObserver | null = null\n\n    if (ref.current) {\n      onResize()\n      window.addEventListener('resize', debouncedOnResize)\n\n      if (supportsResizeObserver) {\n        resizeObserver = new ResizeObserver(onResize)\n        resizeObserver.observe(ref.current)\n      }\n    }\n\n    return () => {\n      window.removeEventListener('resize', debouncedOnResize)\n\n      if (resizeObserver) {\n        resizeObserver.disconnect()\n      }\n    }\n  }, [])\n\n  return size\n}\n","import { FC, useMemo } from 'react'\nimport { motion } from 'framer-motion'\n\nimport { ChildrenRef, DivElementProps, MotionValue } from '../../types'\n\ninterface Props extends DivElementProps {\n  childrenRef: ChildrenRef\n  disabled?: boolean\n  height: number\n  width: number\n  x: MotionValue\n  y: MotionValue\n}\n\nconst FIXED_STYLE = {\n  position: 'fixed',\n  left: 0,\n  top: 0,\n  right: 0,\n  bottom: 0\n}\n\nexport const Wrap: FC<Props> = ({\n  children,\n  childrenRef,\n  disabled,\n  height,\n  style,\n  width,\n  x,\n  y,\n  ...props\n}) => {\n  const outerStyle = useMemo(\n    () => ({ ...style, ...(!disabled ? { height, width } : {}) }),\n    [disabled, height, style, width]\n  )\n  const fixedStyle = useMemo(() => (!disabled ? FIXED_STYLE : {}), [disabled])\n  const motionStyle = useMemo(\n    () => ({ x: !disabled ? x : 0, y: !disabled ? y : 0 }),\n    [disabled, x, y]\n  )\n\n  return (\n    <div {...props} style={outerStyle}>\n      <div style={fixedStyle}>\n        <motion.div style={motionStyle} ref={childrenRef}>\n          {children}\n        </motion.div>\n      </div>\n    </div>\n  )\n}\n","import { forwardRef, useImperativeHandle, useMemo, useRef } from 'react'\n\nimport { Context } from '../../context'\nimport { useCore } from '../../hooks'\nimport { CoreProps, CoreRef } from '../../types'\n\nimport { Wrap } from './Wrap'\n\nconst DEFAULT_SCALE = 1\n\nconst DEFAULT_SPRING = {\n  damping: 50,\n  mass: 1.25,\n  stiffness: 200\n}\n\nexport const Core = forwardRef<CoreRef, CoreProps>(\n  (\n    {\n      children,\n      disabled,\n      scale = DEFAULT_SCALE,\n      spring = DEFAULT_SPRING,\n      ...props\n    },\n    ref\n  ) => {\n    const childrenRef = useRef(null)\n\n    const { height, width, scrollX, scrollY, x, y } = useCore({\n      ref: childrenRef,\n      scale,\n      spring\n    })\n\n    useImperativeHandle(ref, () => ({ scrollX, scrollY, x, y }), [\n      scrollX,\n      scrollY,\n      x,\n      y\n    ])\n\n    const contextValue = useMemo(\n      () => ({ scrollX, scrollY, x, y }),\n      [scrollX, scrollY, x, y]\n    )\n\n    return (\n      <Wrap\n        {...props}\n        childrenRef={childrenRef}\n        disabled={disabled}\n        height={height}\n        width={width}\n        x={x}\n        y={y}\n      >\n        <Context.Provider value={contextValue}>{children}</Context.Provider>\n      </Wrap>\n    )\n  }\n)\n\nCore.displayName = 'ScrollerMotion'\n","import { useMemo } from 'react'\n\nimport { ChildrenRef, SpringProp } from '../../types'\n\nimport { useAxis } from './useAxis'\nimport { useSize } from './useSize'\nimport { useSpringScroll } from './useSpringScroll'\nimport { useWindowSize } from './useWindowSize'\n\ninterface Options {\n  ref: ChildrenRef\n  scale: number\n  spring: SpringProp\n}\n\nexport const useCore = ({ ref, scale, spring }: Options) => {\n  const innerScale = useMemo(() => Math.max(1, scale), [scale])\n\n  const { height: windowHeight, width: windowWidth } = useWindowSize()\n  const { height: refHeight, width: refWidth } = useSize(ref)\n\n  const { x: springX, y: springY } = useSpringScroll(spring)\n\n  const { axis: x, size: width } = useAxis({\n    axisSpring: springX,\n    scale: innerScale,\n    refSize: refWidth,\n    windowSize: windowWidth\n  })\n\n  const { axis: y, size: height } = useAxis({\n    axisSpring: springY,\n    scale: innerScale,\n    refSize: refHeight,\n    windowSize: windowHeight\n  })\n\n  return { height, width, scrollX: springX, scrollY: springY, x, y }\n}\n","import { useEffect, useState } from 'react'\n\nconst getWindowSize = () => ({\n  width:\n    window.innerWidth ||\n    document.documentElement.clientWidth ||\n    document.body.clientWidth,\n  height:\n    window.innerHeight ||\n    document.documentElement.clientHeight ||\n    document.body.clientHeight\n})\n\nexport const useWindowSize = () => {\n  const [size, setSize] = useState({ height: 0, width: 0 })\n\n  useEffect(() => {\n    const onResize = () => setSize(getWindowSize())\n\n    onResize()\n    window.addEventListener('resize', onResize, false)\n\n    return () => window.removeEventListener('resize', onResize, false)\n  }, [])\n\n  return size\n}\n","import { useSpring, useViewportScroll } from 'framer-motion'\n\nimport { MotionValue, SpringProp, SpringOptions } from '../../types'\n\nexport const useSpringScroll = (springConfig: SpringProp) => {\n  const { scrollX, scrollY } = useViewportScroll()\n\n  const config = typeof springConfig === 'object' ? springConfig : undefined\n  const springX: MotionValue<number> = useSpring(\n    scrollX,\n    config as SpringOptions\n  )\n  const springY: MotionValue<number> = useSpring(\n    scrollY,\n    config as SpringOptions\n  )\n\n  return {\n    x: config ? springX : scrollX,\n    y: config ? springY : scrollY\n  }\n}\n","import { useContext } from 'react'\n\nimport { Context } from '../context'\n\nexport const useScrollerMotion = () => {\n  const context = useContext(Context)\n\n  if (context === undefined) {\n    throw new Error('useScrollerMotion must be used within ScrollerMotion')\n  }\n\n  return context\n}\n"],"names":["Context","createContext","undefined","useAxis","_ref","axisSpring","scale","refSize","windowSize","scaledSize","useMemo","transformFrom","transformTo","axis","useTransform","clamp","size","supportsResizeObserver","ResizeObserver","FIXED_STYLE","position","left","top","right","bottom","Wrap","children","childrenRef","disabled","height","style","width","x","y","props","_objectWithoutPropertiesLoose","_excluded","outerStyle","_extends","fixedStyle","motionStyle","_jsx","motion","div","ref","DEFAULT_SPRING","damping","mass","stiffness","Core","forwardRef","_ref$scale","spring","useRef","_useCore","_useState","setSize","innerScale","Math","max","_useWindowSize","useState","useEffect","onResize","window","innerWidth","document","documentElement","clientWidth","body","innerHeight","clientHeight","addEventListener","removeEventListener","windowHeight","windowWidth","el","current","scrollHeight","_el$scrollHeight","scrollWidth","_el$scrollWidth","debouncedOnResize","debounceFn","wait","resizeObserver","observe","disconnect","useSize","refHeight","refWidth","_useSize","useSpringScroll","springConfig","useViewportScroll","scrollX","scrollY","_useViewportScroll","config","springX","useSpring","springY","_useSpringScroll","_useAxis","_useAxis2","useCore","useImperativeHandle","contextValue","Provider","value","displayName","context","useContext","Error"],"mappings":"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"}